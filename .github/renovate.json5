{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: ["github>camunda/infraex-common-config:default.json5"],
  "packageRules": [
    {
      "matchManagers": ["dockerfile", "custom.regex"],
      "groupName": "new major keycloak available",
      "groupSlug": "new-major-keycloak",
      "matchDatasources": ["docker"],
      "matchFileNames": [".watch-latest/Dockerfile*", "keycloak-*/bases.yml"],
      "matchUpdateTypes": ["major"],
      "enabled": true,
      "addLabels": ["dependencies", "docker", "hold"],
    },
    {
      "matchManagers": ["dockerfile", "custom.regex"],
      "groupName": "all non-major keycloak",
      "groupSlug": "all-non-major-keycloak",
      "matchDatasources": ["docker"],
      "matchFileNames": ["keycloak-*/Dockerfile", "keycloak-*/bases.yml"],
      "versioning": "regex:^(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)(:?-(?<compatibility>.+)(?<build>\\d+)-r(?<revision>\\d+))?$",
      "enabled": true,
      "addLabels": ["dependencies", "docker"],
    },
    {
      "matchManagers": ["dockerfile", "custom.regex"],
      "matchDatasources": ["docker"],
      "matchFileNames": ["keycloak-*/Dockerfile", "keycloak-*/bases.yml"],
      "matchUpdateTypes": ["major"],
      "enabled": false,
    },
  ],
  // TODO: integrates this into the common-config
  // we will also need to add INFRAEX_CAMUNDA_DOCKER_REGISTRY_PASSWORD
  hostRules: [
    {
      hostType: 'docker',
      matchHost: 'https://registry.camunda.cloud',
      username: 'ci-infraex',
      password: '{{ secrets.INFRAEX_CAMUNDA_DOCKER_REGISTRY_PASSWORD }}',
    },
  ],
  "customManagers": [
           {
             "customType": "regex",
             "managerFilePatterns": ["**/bases.yaml"],
             "matchStrings": [
                "\\s+image: (?<depName>.*?)(?::(?<currentValue>.*?))?@(?<currentDigest>sha256:[a-f0-9]+)\\s"
             ],
             "datasourceTemplate": "docker",
             "versioningTemplate": "docker",
             "autoReplaceStringTemplate": "name: {{{depName}}}:{{{newValue}}}@{{{newDigest}}}"
           }
         ],
}
